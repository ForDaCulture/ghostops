# SpecterOps Sentinel

**SpecterOps Sentinel** is a modular, featureâ€‘engineered machineâ€‘learning pipeline for detecting network anomalies in packet captures. Built as part of the **GhostOps** portfolio, this project demonstrates endâ€‘toâ€‘end cybersecurity and ML expertise.

---

## ğŸš€ Key Features

- **Rich Feature Set**  
  - Packet length, IP protocol, TTL  
  - Payload entropy & entropy/length ratio  
  - Interâ€‘arrival time (IAT)  
  - Source/destination ports, TCP flags, SYNâ€‘withoutâ€‘ACK  
  - Traffic direction (inbound vs outbound), port common vs ephemeral ratio

- **Fourâ€‘Stage Pipeline**  
  1. **Training** (`train_model.py`): Builds an IsolationForest on benign traffic.  
  2. **Evaluation** (`evaluate_model.py`): Computes ROC/AUC; finds optimal threshold.  
  3. **Offline Analysis** (`analyze_pcap.py`): Scores PCAPs, flags anomalies with a fixed cutoff.  
  4. **Live Sniffer** (`tools/anomaly_sniffer.py`): Realâ€‘time anomaly detection on interfaces or replay.

- **Dataâ€‘Driven Tuning**  
  - Adjustable contamination for training  
  - ROCâ€‘based or fixedâ€‘offset cutoff selection  
  - Placeholderâ€‘driven CLI for your network (`<PCAP_PATH>`, `<LOCAL_IP>`, `<INTERFACE>`)

---

## ğŸ“ Repository Structure
SpecterOps_Sentinel/
â”œâ”€â”€ data/ # (not tracked) your PCAPs & model outputs
â”œâ”€â”€ tools/
â”‚ â”œâ”€â”€ anomaly_sniffer.py # Live/offline sniffer
â”‚ â””â”€â”€ dns_exfil_classifier.py
â”œâ”€â”€ train_model.py
â”œâ”€â”€ evaluate_model.py
â”œâ”€â”€ analyze_pcap.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ tests/
â”‚ â””â”€â”€ test_dns_exfil.py
â””â”€â”€ README.md


---

## ğŸ”§ Installation

```bash
git clone https://github.com/<YOUR_USERNAME>/GhostOps.git
cd GhostOps/SpecterOps_Sentinel

python3 -m venv venv
source venv/bin/activate        # macOS/Linux
.\venv\Scripts\Activate.ps1     # Windows PowerShell

pip install -r requirements.txt

ğŸ“ How to Use
1. Train the Model
bash
python train_model.py \
  --pcap data/benign.pcap \
  --model data/model.joblib \
  --local-ip <YOUR_HOST_IP> \
  --contamination 0.001
2. Evaluate Performance
bash
Copy
Edit
python evaluate_model.py \
  --benign data/benign.pcap \
  --malicious data/malicious.pcap \
  --model data/model.joblib \
  --local-ip <YOUR_HOST_IP>
3. Offline PCAP Analysis
bash
Copy
Edit
python analyze_pcap.py \
  --pcap data/target.pcap \
  --model data/model.joblib \
  --local-ip <YOUR_HOST_IP> \
  --cutoff <THRESHOLD>
4. Live Anomaly Sniffer
bash
Copy
Edit
python tools/anomaly_sniffer.py \
  --iface <INTERFACE> \
  --model data/model.joblib \
  --local-ip <YOUR_HOST_IP> \
  --threshold 0.05
ğŸ“ˆ Fineâ€‘Tuning Workflow
Pick a contamination rate for expected anomalies (e.g. 0.001).

Train on benign traffic.

Evaluate via ROC to find AUC & optimal cutoff.

Analyze benign & malicious PCAPs to confirm FP/TP rates.

Adjust contamination or cutoff until you hit your target (e.g. <â€¯1â€¯% FP, >â€¯70â€¯% TP).

ğŸ“œ License
This project is licensed under the MIT License.
Feel free to fork and adapt for your own security automations!

